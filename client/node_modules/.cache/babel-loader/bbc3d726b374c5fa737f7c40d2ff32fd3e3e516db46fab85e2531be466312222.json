{"ast":null,"code":"// client/src/features/adminSlice.js\nimport { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport axios from 'axios';\nconst API_URL = '/api/admin';\n\n// Fetch usage statistics (users, files, analyses count)\nexport const fetchStats = createAsyncThunk('admin/fetchStats', async (_, thunkAPI) => {\n  try {\n    const token = thunkAPI.getState().auth.token;\n    const res = await axios.get(API_URL + '/stats', {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    return res.data; // { userCount, fileCount, analysisCount }\n  } catch (error) {\n    var _error$response, _error$response$data;\n    return thunkAPI.rejectWithValue(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || error.message);\n  }\n});\n\n// Fetch all users for admin to manage\nexport const fetchUsers = createAsyncThunk('admin/fetchUsers', async (_, thunkAPI) => {\n  try {\n    const token = thunkAPI.getState().auth.token;\n    const res = await axios.get(API_URL + '/users', {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    return res.data; // array of users\n  } catch (error) {\n    var _error$response2, _error$response2$data;\n    return thunkAPI.rejectWithValue(((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message) || error.message);\n  }\n});\n\n// Delete user by admin\nexport const deleteUser = createAsyncThunk('admin/deleteUser', async (userId, thunkAPI) => {\n  try {\n    const token = thunkAPI.getState().auth.token;\n    await axios.delete(`${API_URL}/users/${userId}`, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    return userId;\n  } catch (error) {\n    var _error$response3, _error$response3$data;\n    return thunkAPI.rejectWithValue(((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : (_error$response3$data = _error$response3.data) === null || _error$response3$data === void 0 ? void 0 : _error$response3$data.message) || error.message);\n  }\n});\nconst adminSlice = createSlice({\n  name: 'admin',\n  initialState: {\n    stats: {},\n    users: [],\n    loading: false,\n    error: null,\n    successMessage: null\n  },\n  reducers: {\n    clearAdminState(state) {\n      state.loading = false;\n      state.error = null;\n      state.successMessage = null;\n    }\n  },\n  extraReducers: builder => {\n    builder\n    // Fetch stats\n    .addCase(fetchStats.pending, state => {\n      state.loading = true;\n      state.error = null;\n    }).addCase(fetchStats.fulfilled, (state, action) => {\n      state.loading = false;\n      state.stats = action.payload;\n    }).addCase(fetchStats.rejected, (state, action) => {\n      state.loading = false;\n      state.error = action.payload || 'Failed to fetch statistics.';\n    })\n\n    // Fetch users\n    .addCase(fetchUsers.pending, state => {\n      state.loading = true;\n      state.error = null;\n    }).addCase(fetchUsers.fulfilled, (state, action) => {\n      state.loading = false;\n      state.users = action.payload;\n    }).addCase(fetchUsers.rejected, (state, action) => {\n      state.loading = false;\n      state.error = action.payload || 'Failed to fetch users.';\n    })\n\n    // Delete user\n    .addCase(deleteUser.pending, state => {\n      state.error = null;\n    }).addCase(deleteUser.fulfilled, (state, action) => {\n      state.users = state.users.filter(user => user._id !== action.payload);\n      state.successMessage = 'User deleted successfully.';\n    }).addCase(deleteUser.rejected, (state, action) => {\n      state.error = action.payload || 'Failed to delete user.';\n    });\n  }\n});\nexport const {\n  clearAdminState\n} = adminSlice.actions;\nexport default adminSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","API_URL","fetchStats","_","thunkAPI","token","getState","auth","res","get","headers","Authorization","data","error","_error$response","_error$response$data","rejectWithValue","response","message","fetchUsers","_error$response2","_error$response2$data","deleteUser","userId","delete","_error$response3","_error$response3$data","adminSlice","name","initialState","stats","users","loading","successMessage","reducers","clearAdminState","state","extraReducers","builder","addCase","pending","fulfilled","action","payload","rejected","filter","user","_id","actions","reducer"],"sources":["C:/Users/lenovo/Desktop/excel/client/src/features/adminSlice.js"],"sourcesContent":["// client/src/features/adminSlice.js\r\nimport { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\r\nimport axios from 'axios';\r\n\r\nconst API_URL = '/api/admin';\r\n\r\n// Fetch usage statistics (users, files, analyses count)\r\nexport const fetchStats = createAsyncThunk(\r\n  'admin/fetchStats',\r\n  async (_, thunkAPI) => {\r\n    try {\r\n      const token = thunkAPI.getState().auth.token;\r\n      const res = await axios.get(API_URL + '/stats', {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      return res.data; // { userCount, fileCount, analysisCount }\r\n    } catch (error) {\r\n      return thunkAPI.rejectWithValue(\r\n        error.response?.data?.message || error.message\r\n      );\r\n    }\r\n  }\r\n);\r\n\r\n// Fetch all users for admin to manage\r\nexport const fetchUsers = createAsyncThunk(\r\n  'admin/fetchUsers',\r\n  async (_, thunkAPI) => {\r\n    try {\r\n      const token = thunkAPI.getState().auth.token;\r\n      const res = await axios.get(API_URL + '/users', {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      return res.data; // array of users\r\n    } catch (error) {\r\n      return thunkAPI.rejectWithValue(\r\n        error.response?.data?.message || error.message\r\n      );\r\n    }\r\n  }\r\n);\r\n\r\n// Delete user by admin\r\nexport const deleteUser = createAsyncThunk(\r\n  'admin/deleteUser',\r\n  async (userId, thunkAPI) => {\r\n    try {\r\n      const token = thunkAPI.getState().auth.token;\r\n      await axios.delete(`${API_URL}/users/${userId}`, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      return userId;\r\n    } catch (error) {\r\n      return thunkAPI.rejectWithValue(\r\n        error.response?.data?.message || error.message\r\n      );\r\n    }\r\n  }\r\n);\r\n\r\nconst adminSlice = createSlice({\r\n  name: 'admin',\r\n  initialState: {\r\n    stats: {},\r\n    users: [],\r\n    loading: false,\r\n    error: null,\r\n    successMessage: null,\r\n  },\r\n  reducers: {\r\n    clearAdminState(state) {\r\n      state.loading = false;\r\n      state.error = null;\r\n      state.successMessage = null;\r\n    },\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder\r\n      // Fetch stats\r\n      .addCase(fetchStats.pending, (state) => {\r\n        state.loading = true;\r\n        state.error = null;\r\n      })\r\n      .addCase(fetchStats.fulfilled, (state, action) => {\r\n        state.loading = false;\r\n        state.stats = action.payload;\r\n      })\r\n      .addCase(fetchStats.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.payload || 'Failed to fetch statistics.';\r\n      })\r\n\r\n      // Fetch users\r\n      .addCase(fetchUsers.pending, (state) => {\r\n        state.loading = true;\r\n        state.error = null;\r\n      })\r\n      .addCase(fetchUsers.fulfilled, (state, action) => {\r\n        state.loading = false;\r\n        state.users = action.payload;\r\n      })\r\n      .addCase(fetchUsers.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.payload || 'Failed to fetch users.';\r\n      })\r\n\r\n      // Delete user\r\n      .addCase(deleteUser.pending, (state) => {\r\n        state.error = null;\r\n      })\r\n      .addCase(deleteUser.fulfilled, (state, action) => {\r\n        state.users = state.users.filter((user) => user._id !== action.payload);\r\n        state.successMessage = 'User deleted successfully.';\r\n      })\r\n      .addCase(deleteUser.rejected, (state, action) => {\r\n        state.error = action.payload || 'Failed to delete user.';\r\n      });\r\n  },\r\n});\r\n\r\nexport const { clearAdminState } = adminSlice.actions;\r\n\r\nexport default adminSlice.reducer;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}